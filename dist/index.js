!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.VhxApi=e()}(this,function(){"use strict";var o="api.vhx.tv",r="https://",n="30000",i="1800000";function p(t){return t&&isNaN(parseInt(t,10))}function s(t){var e=typeof t;return"function"===e||"object"===e&&!!t}function c(t){return t&&!!(t&&t.constructor&&t.call&&t.apply)}function a(t,e,o){return"products"===e.path?u(t,e,o):"videos"===e.path?u(t,e,o):"collections"===e.path?u(t,e,o):"customers"===e.path?u(t,e,o):"browse"===e.path?function(t,e){if(s(t))return""+e._api.protocol+e._api.host+"/"+e.path;return""+e._api.protocol+e._api.host+"/"+e.path+"?product="+t}(t,e):h(e)}var u=function(t,e,o){return o&&o.scope&&"items"!==o.scope?t&&p(t)?t+"/"+o.scope:""+e._api.protocol+e._api.host+"/"+e.path+"/"+t+"/"+o.scope:o&&o.scope&&"items"===o.scope?t&&p(t)?t:""+e._api.protocol+e._api.host+"/"+e.path+"/"+t+"/"+o.scope:t&&p(t)&&!c(t)&&!s(t)?t:!t||c(t)||s(t)?h(e):""+e._api.protocol+e._api.host+"/"+e.path+"/"+t},h=function(t){return""+t._api.protocol+t._api.host+"/"+t.path},t=function(t,e,o,r){this._api=t,this.methods=o,this.path=e,this.init()};t.prototype.init=function(){var n=this;this.methods.forEach(function(t){var e,o=s(e=t)&&e.method?e.method:e,r={http_method:"get",client_method:o};o.match(/update|addItem|addProduct/)&&(r.http_method="put"),o.match(/create/)&&(r.http_method="post"),o.match(/removeItem|removeProduct/)&&(r.http_method="delete"),o.match(/files|items|watching|watchlist/)&&(r.scope=t),o.match(/addItem|removeItem/)&&(r.scope="items"),n[o]=function(t,e){return r.url=a(t,n,r),s(t)?r.options=t:r.options=e,n.createRequestParams(r)}})},t.prototype.getParams=function(t,e,o,r,n){var i={timeout:this._api.timeout,method:t,url:e};return s(o)&&(i.qs=o||null),this._api.auth&&(i.headers={"X-Requested-With":"XMLHttpRequest",Accept:"application/json","Content-Type":"application/json",Authorization:this._api.auth}),this._api.internal&&(i.headers={"X-Requested-With":"XMLHttpRequest",Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer "+this._api.token}),i},t.prototype.createRequestParams=function(t){var e=this.getParams(t.client_method,t.url,t.options,t.scope,t.read_only);return this.fetchRequest(t,e)},t.prototype.fetchRequest=function(e,t){var o=new URL(t.url);return e.options&&Object.keys(e.options).forEach(function(t){e.options[t]&&o.searchParams.append(t,e.options[t])}),fetch(o.href,{method:e.http_method,headers:t.headers,credentials:"include"}).then(function(t){return t.ok?204===t.status?{}:t.json():Promise.reject({status:t.status,statusText:t.statusText})})};var e=function(e){function t(t){e.call(this,t,"collections",["all","retrieve","items","update","create","addItem","removeItem"])}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(t),l=function(e){function t(t){e.call(this,t,"videos",["all","retrieve","files","create","update"])}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(t),d=function(e){function t(t){e.call(this,t,"customers",["retrieve","all","watching","watchlist","addProduct","removeProduct","update"])}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(t),f=function(e){function t(t){e.call(this,t,"browse",["list"])}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(t),_={products:function(e){function t(t){e.call(this,t,"products",["retrieve","all"])}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(t),browse:f,videos:l,collections:e,customers:d,analytics:function(e){function t(t){e.call(this,t,"analytics",["retrieve"])}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t}(t)};"undefined"==typeof btoa&&(global.btoa=function(t){return new Buffer(t).toString("base64")});var m=function(t,e){void 0===e&&(e={}),this.api=e.internal?this.setToken(t,e):this.setApi(t,e),this.prepareResources()};return m.prototype.setApi=function(t,e){return void 0===e&&(e={}),{auth:"Basic "+btoa(t),host:e.host||o,protocol:e.protocol||r,timeout:n,token_expiration:null}},m.prototype.setToken=function(t,e){return void 0===e&&(e={}),{token:t,host:e.host||o,protocol:e.protocol||r,timeout:e.timeout||n,token_expiration:e.TOKEN_EXPIRES_IN||i,internal:!0}},m.prototype.prepareResources=function(){for(var t in _)this[t[0].toLowerCase()+t.substring(1)]=new _[t](this.api)},m});
//# sourceMappingURL=index.js.map
